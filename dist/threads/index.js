"use strict";var s=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var k=(e,r)=>{for(var i in r)s(e,i,{get:r[i],enumerable:!0})},y=(e,r,i,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of w(r))!f.call(e,n)&&n!==i&&s(e,n,{get:()=>r[n],enumerable:!(o=T(r,n))||o.enumerable});return e};var W=e=>y(s({},"__esModule",{value:!0}),e);var S={};k(S,{getRegistration:()=>p,isServiceWorkerSupported:()=>g,registerThreads:()=>u,thread:()=>h,unregisterThreads:()=>v});module.exports=W(S);var t=null,a=new Map;async function u(e={}){if(typeof window>"u"||!("serviceWorker"in navigator))throw new Error("Service Workers are not supported in this environment");let{workerPath:r="/worker.js",scope:i="/",type:o="classic"}=e;try{return t=await navigator.serviceWorker.register(r,{scope:i,type:o}),navigator.serviceWorker.addEventListener("message",n=>{let{threadName:d,data:l}=n.data,c=a.get(d);c&&(c(l),a.delete(d))}),t}catch(n){throw new Error(`Failed to register service worker: ${n}`)}}function x(){if(!t)throw new Error("Service worker not registered. Call registerThreads() first.");let e=t.active||t.waiting||t.installing;if(!e)throw new Error("No active service worker found");return e}function h(e){return{execute(r){return x().postMessage({threadName:e,data:r}),{finish(o){a.set(e,o)}}}}}function g(){return typeof window<"u"&&"serviceWorker"in navigator}function p(){return t}async function v(){if(!t)return!1;let e=await t.unregister();return t=null,a.clear(),e}0&&(module.exports={getRegistration,isServiceWorkerSupported,registerThreads,thread,unregisterThreads});
